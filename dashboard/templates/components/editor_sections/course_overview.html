<div class="form-section editor-entity-section overview-editor-section">
  <div class="entity-header">
    <div>
      <div class="form-section-title mb-1">Overview Intro</div>
      <div class="editor-note">Intro text shown above the overview questions on the course page.</div>
    </div>
  </div>
  <form method="POST" action="{% url 'dashboard' %}" class="entity-form overview-intro-form">
    {% csrf_token %}
    <input type="hidden" name="action" value="save_course_overview" />
    <input type="hidden" name="course" value="{{ selected_course.id }}" />
    <div>
      <label class="form-label">Intro Text</label>
      <input type="hidden" name="intro_html" id="overview-intro-html" value="{{ course_overview.intro_html|default:'' }}" />
      <div class="form-control overview-quill" style="padding: 0;" data-quill data-target="overview-intro-html"></div>
    </div>
    <div class="entity-actions overview-form-actions">
      <button class="btn btn-primary" type="submit">Save Overview Intro</button>
    </div>
  </form>
</div>

<div class="form-section editor-entity-section overview-editor-section">
  <div class="entity-header">
    <div>
      <div class="form-section-title mb-1">Overview Questions</div>
      <div class="editor-note">Add FAQ-style questions and answers. Edit happens inline without reloading the page.</div>
    </div>
    <div class="entity-mode-badge" data-overview-item-mode>
      {% if editing.course_overview_item %}Editing question{% else %}Add question{% endif %}
    </div>
  </div>

  <form method="POST" action="{% url 'dashboard' %}" class="entity-form overview-question-form" data-overview-item-form>
    {% csrf_token %}
    <input type="hidden" name="action" value="save_course_overview_item" />
    <input type="hidden" name="course" value="{{ selected_course.id }}" />
    <input type="hidden" name="item_id" value="{% if editing.course_overview_item %}{{ editing.course_overview_item.id }}{% endif %}" data-overview-item-id />

    <div class="row g-3">
      <div class="col-12">
        <label class="form-label">Question</label>
        <input
          type="text"
          class="form-control"
          name="question"
          value="{% if editing.course_overview_item %}{{ editing.course_overview_item.question }}{% endif %}"
          placeholder="e.g. Who is this course for?"
          required
          data-overview-question-input
        />
        <div class="editor-note mt-2">Keep it concise so it looks clean in the FAQ accordion.</div>
      </div>
      <div class="col-12">
        <label class="form-label">Answer</label>
        <input
          type="hidden"
          name="answer_html"
          id="overview-answer-html"
          value="{% if editing.course_overview_item %}{{ editing.course_overview_item.answer_html }}{% endif %}"
          data-overview-answer-input
        />
        <div class="form-control overview-quill overview-answer-editor" style="padding: 0;" data-quill data-target="overview-answer-html"></div>
      </div>
    </div>

    <div class="entity-actions overview-form-actions">
      <button class="btn btn-primary" type="submit" data-overview-item-submit>
        {% if editing.course_overview_item %}Update Question{% else %}Add Question{% endif %}
      </button>
      <button
        class="btn btn-outline-secondary {% if not editing.course_overview_item %}d-none{% endif %}"
        type="button"
        data-overview-item-cancel
      >
        Cancel
      </button>
    </div>
  </form>

  <div class="overview-list-wrap mt-3">
    <div class="overview-list-head">
      <div class="form-label mb-0">Saved Questions</div>
      <span class="badge-soft">{{ course_overview_items|length }} item{{ course_overview_items|length|pluralize }}</span>
    </div>

    <ul class="list-group list-group-flush entity-list overview-item-list" data-overview-items-list>
      {% for item in course_overview_items %}
        <li class="list-group-item" data-overview-item="{{ item.id }}">
          <article class="entity-item overview-item-card">
            <div class="entity-main">
              <div class="entity-thumb-wrap overview-item-badge" aria-hidden="true">
                <i class="bi bi-question-circle"></i>
              </div>
              <div class="overview-item-text">
                <div class="entity-title overview-item-question">{{ item.question }}</div>
                <div class="overview-item-answer">
                  {{ item.answer_html|striptags|truncatechars:160|default:"No answer text." }}
                </div>
              </div>
            </div>
            <div class="entity-item-actions" role="group" aria-label="Overview question actions">
              <button
                type="button"
                class="btn btn-sm btn-outline-secondary"
                data-overview-item-edit
                data-item-id="{{ item.id }}"
                data-question="{{ item.question|escape }}"
                data-answer-html="{{ item.answer_html|escape }}"
                title="Edit question"
                aria-label="Edit question"
              >
                <i class="bi bi-pencil"></i>
              </button>
              <form method="POST" action="{% url 'dashboard' %}" class="d-inline">
                {% csrf_token %}
                <input type="hidden" name="action" value="delete_course_overview_item" />
                <input type="hidden" name="course" value="{{ selected_course.id }}" />
                <input type="hidden" name="item_id" value="{{ item.id }}" />
                <button class="btn btn-sm btn-outline-danger" type="submit" title="Delete question" aria-label="Delete question">
                  <i class="bi bi-trash"></i>
                </button>
              </form>
            </div>
          </article>
        </li>
      {% empty %}
        <li class="list-group-item" data-overview-items-empty>
          <div class="entity-empty-state">No overview questions yet. Add your first question above.</div>
        </li>
      {% endfor %}
    </ul>
  </div>
</div>

